0. 工具總體定位（給知識庫首頁）
工具名稱： 部門級年終獎金分配器 MVP目標：讓 5–50 人中小企業主，在輸入「營收 × 行業 × 毛利 × 月人事成本 × 部門配置 × 增長引擎」之後，得到一套 財務安全邊界內 的「年終獎金部門分配建議」，並附帶：
企業發展階段診斷（生存／組織／擴展／規模）
HR Ratio 是否超支的風險警示
若超支時的妥協分配方案（誰優先、誰象徵性發放）
與增長引擎一致的部門優先順序與說明話術

1. 核心概念與名詞定義
1.1 行業 × 毛利率（Industry → Gross Margin）
目的：幫企業主「不用真的算毛利」，只要選行業，系統就給一個「行業中位數毛利率」，再讓老闆微調。
行業大分類（IndustryCategory）
例如：
agriculture：🌾 農業、林業、漁業、牧業
retail：🛒 批發與零售業
restaurant：🍽️ 餐飲業
hospitality：🏨 住宿與旅遊業
manufacturing：🏭 製造業
construction：🏗️ 營造業與不動產
transportation：🚚 運輸、物流與倉儲

it_services：💻 資訊技術與軟體服務
professional_services：👔 專業服務與顧問業
healthcare：🏥 醫療保健與社會福利
education：📚 教育與培訓服務
finance_insurance：💰 金融與保險服務
personal_services：💆 個人服務與生活服務
每個大類底下有多個「具體行業」，各自設定 毛利率中位數（margin，0~1）。

具體行業（IndustryInfo）
欄位
name：中文名稱（例：水果種植農場、超市／生鮮雜貨店）
margin：該行業的 預設毛利率中位數（例如：0.75＝75%）
毛利率計算邏輯
industryGrossMarginPct：系統根據「具體行業」自動抓的行業中位數毛利率
userGrossMarginPct：老闆自己選擇的「毛利率區間」代表值
30% 以下：0.30
30%~40%：0.35
40%~50%：0.45
50%~60%：0.55
60%~70%：0.65
70% 以上：0.75
不確定：使用 industryGrossMarginPct

finalGrossMarginPct：加權平均毛利率

演算法：final = 行業中位數 * 70% + 使用者自估 * 30%
解讀：
以行業中位數為主（70%），老闆的直覺當作微調（30%），避免老闆過度樂觀或悲觀。

1.2 企業發展階段（EnterpriseStage）
四階段：
🔴 生存期 survival
HR Ratio 範圍：30% ~ 40%
說明：保命、現金流優先
邏輯：老闆省、現金流第一，不允許高薪高獎金
工具意義：幫助控制現金流、獎金集中在年底
獎金拆分（相對人事成本）：
totalBonusRatio：0.30（總獎金：薪獎預算的 30%
季獎金：1.5%
年終獎金：24%

🟡 組織期 organization
HR Ratio 範圍：40% ~ 50%
說明：穩定輸出＋開始追求短期成果


邏輯：開始用專才、留人才，部門承載力變重要
工具意義：平衡短期與長期激勵
獎金拆分：
總獎金：30%
季獎金：3%
年終獎金：18%

🟢 擴展期 expansion
HR Ratio 範圍：50% ~ 60%
說明：速度優先
邏輯：重人才、重速度，績效薪資占比高
工具意義：短期激勵為主，快打市場
獎金拆分：
總獎金：30%
季獎金：4%
年終獎金：14%

🔵 規模期 scale
HR Ratio 範圍：45% ~ 55%
說明：穩定、效率、降低變動
邏輯：降本增效，固定薪＋少量獎金
工具意義：穩定激勵、控制變動成本

獎金拆分：
總獎金：30%
季獎金：3%
年終獎金：18%

知識點：「人事成本比例」是用來判斷企業所處階段與風險的主軸。不同階段，獎金結構不一樣，但「獎金總體約佔人事成本 30%」這件事是共通設計。

1.3 增長引擎（Growth Engine）
六種：
sales_led：Sales-led（銷售驅動）
ops_led：Ops-led（營運驅動）
media_led：Media-led（媒體／內容驅動）
channel_led：Channel-led（通路驅動）
founder_led：Founder-led（創辦人驅動）
product_led：Product-led（產品驅動）

描述（engineDescriptions）：
銷售驅動：主要靠業務開發與談判成長
營運驅動：主要靠流程優化與效率提升成長
媒體驅動：靠品牌與內容曝光成長
通路驅動：靠合作夥伴、平台、通路擴展成長
創辦人驅動：高度依賴老闆個人影響力
產品驅動：靠新產品與創新成長

1.4 部門類型（7 大部門）
部門類型（DepartmentMVP.type）：
hr：人事部
sales：業務銷售
assets_finance：資產財務
product_service：產品／服務交付（營運）
rd_qa：研發／品管
pr_marketing：公關行銷
management：管理層（含老闆）
每個部門有：
name：自訂部門名稱（如「台北門市」、「企業業務部」）
type：上述七類之一
headcount：人數


2. 使用者輸入與工具輸出
2.1 使用者輸入（CompanyInputMVP）
companyName：公司名稱
revenue：年營收（萬元）
例：輸入 5000 ＝ 年營收 5000 萬
industryCategoryKey：行業大分類 key
industryKey：具體行業 key
industryGrossMarginPct：該行業中位數毛利率
userGrossMarginPct：使用者選的毛利區間代表值
finalGrossMarginPct：加權後毛利率（工具計算）
monthlyHRCost：每月薪資＋獎金成本（萬元），不含法定成本

2.2 工具主要輸出（BonusResultMVP）
整體數字
grossProfit：年毛利（元）
annualHRCost：年人事總成本（薪資＋獎金＋法定成本）（元）
hrRatio：HR Ratio = 年人事成本 / 年毛利
enterpriseStage & stageDescription：企業發展階段與名稱
primaryEngine & engineDescription：主增長引擎與描述
totalBonusPool：可用於「年終獎金」的獎金池（元）

理想結構（以「理想人事成本」為母數）
idealHRCost：理論上該階段建議的人事成本上限（元）
idealSalaryCost：63% 薪資成本
idealBonusCost：25% 獎金成本（季＋年終）
idealLegalCost：12% 法定成本

部門分配結果（每個部門一筆 AllocationResultMVP）
departmentName
departmentType
bonusAmount：部門年終獎金金額
percentage：在本次分配中的比例（%）
perCapita：部門人均年終獎金
reason：分配原因（含「引擎＋權重＋層級」敘述）

風險警示（HRRatioWarning）
是否異常：isAbnormal（hrRatio > 60%）
riskLevel：high / critical
warningMessage：一整段話術（階段建議範圍、目前狀況、影響、應投資但沒錢投的項目）
compromiseSolution：妥協方案（優先部門、次要部門、象徵性發放部門）

3. 計算流程（給顧問＆工程共用的邏輯說明）
3.1 毛利與人事成本換算
年毛利（grossProfit）
年營收（元） = revenue（萬元） × 10,000
毛利 = 年營收 × finalGrossMarginPct
年人事成本（annualHRCost）

使用者輸入的是：
每月薪資＋獎金成本（不含法定成本，萬元）
換算：
salaryAndBonusYear = monthlyHRCost × 10,000 × 12
法定成本（勞保＋健保＋勞退 6%）假設佔 整體人事成本的 12%：→ 也就是薪資＋獎金 = 88%，法定 = 12%
legalCost = salaryAndBonusYear × (12 / 88)
annualHRCost = salaryAndBonusYear + legalCost

HR Ratio
hrRatio = annualHRCost / grossProfit

3.2 企業發展階段判斷（calculateEnterpriseStage）
核心邏輯
先依「營收 × 毛利」算出一個基準階段（Base Stage）
以「毛利率 50%」為基準假設時，營收門檻（單位：萬元）為：
生存期（survival）：年營收 ＜ 1000 萬
組織期（organization）：1000 萬 ≤ 年營收 ＜ 5000 萬
擴展期（expansion）：5000 萬 ≤ 年營收 ＜ 20000 萬
規模期（scale）：年營收 ≥ 20000 萬
若實際毛利 < 50%，放大營收門檻（讓「毛利越低，越難升級階段」）
使用毛利調整係數：
marginAdjustment = grossMarginPct < 0.5 
                   ? (0.5 / grossMarginPct) 
                   : 1

若毛利 ≥ 50%：➜ marginAdjustment = 1（不調整門檻）
若毛利 < 50%：➜ marginAdjustment = 0.5 / 毛利率（> 1，只會提高門檻，不會降低）
調整後門檻＝基準門檻 × marginAdjustment
🔍 具體例子：
進入「組織期」的門檻：基準 1000 萬（50% 毛利）
毛利 50%：marginAdjustment = 0.5 / 0.5 = 1→ 組織期門檻 = 1000 × 1 = 1000 萬
毛利 40%：marginAdjustment = 0.5 / 0.4 = 1.25→ 組織期門檻 = 1000 × 1.25 = 1250 萬✅ 就是你說的「40% 毛利就要 1250 萬才能進入組織階段」
進入「擴展期」的門檻：基準 5000 萬（50% 毛利）
毛利 50%：marginAdjustment = 1→ 擴展期門檻 = 5000 × 1 = 5000 萬
毛利 40%：marginAdjustment = 1.25→ 擴展期門檻 = 5000 × 1.25 = 6250 萬✅ 對應你說的「40% 毛利就要 6250 才能進入擴展階段」
（同理，20000 萬的規模期門檻也會乘上同一個 marginAdjustment）
**一、企業發展階段（Enterprise Stage）
— 只看兩個指標：營收 × 毛利率**
用途：決定獎金策略的財務錨點（bonus strategy anchor）不受 HR Ratio 影響。

1.1 判斷原則（核心理念）
企業成長能力的本質不是人事成本高低，而是：
1️⃣ 營收規模（Revenue）2️⃣ 毛利率（Gross Margin）
毛利越高 → 越容易撐起團隊 → 較容易進入下一階段毛利越低 → 同樣的營收也更吃力 → 需要更高營收才能達到下一階段

1.2 基準營收門檻（假設毛利率 50% 時）


1.3 毛利調整係數（Margin Adjustment）
因為企業的發展能力取決於「毛利能否養人」，所以門檻需依毛利調整：
公式：
marginAdjustment = grossMarginPct < 0.5 
                   ? (0.5 / grossMarginPct)
                   : 1
毛利 ≥ 50% → 門檻維持原樣（不調整）
毛利 < 50% → 門檻 × (0.5 ÷ 毛利率)→ 毛利越低 → 門檻越高 → 越難升級階段

1.4 調整後門檻（Final Threshold）
finalThreshold = baseThreshold × marginAdjustment
✔ 例子（你提供的兩個，我整合成完整表）：
進入組織期門檻（基準：1000 萬）

進入擴展期門檻（基準：5000 萬）

—
1.5 企業階段判斷流程（工程可直接用）
1. 取得 grossMarginPct（最終毛利率）2. 計算 marginAdjustment = (grossMargin < 0.5) ? 0.5/grossMargin : 13. 取得 base stage revenue threshold4. finalThreshold = baseThreshold × marginAdjustment5. compare revenue with finalThreshold → 得到 stage
不需要 HR Ratio。

**二、人事成本風險（HR Ratio Risk）
— 完全獨立，不用來決定企業階段**
用途：提示企業主「人事成本是否健康」，並調整獎金建議。

2.1 判斷指標
HR Ratio = 年度人事成本 ÷ 年毛利
（包含薪水、獎金、勞健保、勞退）

2.2 HR Ratio 區間分類（Risk Tier）


2.3 輸出項目（系統要給）
isWarning
riskLevel
warningMessage
conservativeBonusPool
recommendedDepartmentsPriority

這些完全獨立於企業階段判斷。

三、為什麼要將「企業階段」與「HR Ratio」分開？（知識庫說明用）
1️⃣ 企業階段代表：企業的「能力」與「階段性任務」
由營收 × 毛利決定，非常客觀。
2️⃣ HR Ratio 代表：企業的「行為」與「用人成本風險」
不該影響企業屬於哪個階段。
❌ 若混在一起 → 會造成邏輯混亂：
例如：
一間營收 1 億公司，只因 HR Ratio 低，不能稱為「生存期」
或營收 800 萬的公司 HR Ratio 高，也不能叫做「擴展期」
這會讓企業主完全聽不懂你在說什麼。

四、顧問版說法（講課可直接用）
⭐ 企業階段，只看兩件事：
你賺多少（營收）你賺得多不多（毛利）
這代表你的「養人能力」。

⭐ HR Ratio，不是決定你在哪個階段
是決定：
你現在用人的方式，有沒有吃掉你的未來？
HR Ratio 偏高 → 先發警示，再建議保守發獎金。HR Ratio 偏低 → 代表你太省，但不是階段低。

五、整體模型摘要（最精華版，可放在 KB 頂部）
📌 階段 = 營收 × 毛利調整門檻（不含 HR Ratio）
📌 風險 = HR Ratio（不影響階段，只影響獎金建議）
這套分離式架構簡單、乾淨、可說服企業主，也符合你的產品定位。

知識庫重點：
階段判斷 = 營收 × 毛利（不含 HR Ratio）
HR Ratio 只影響「風險提示與獎金建議」，不影響階段。
階段判斷不是讓老闆選，而是系統根據「營收 × 毛利」自動判斷，目的是讓「獎金建議」有財務邏輯的錨點。

3.3 HR Ratio 風險分析（analyzeHRRatio）
觸發條件：
hrRatio > 60% → 視為異常高人事成本
風險等級：
60%–65%：high
65%–80%：critical
80%：critical（極高風險）
警告內容（generateWarningMessage）：
告訴老闆：
你目前處於哪個階段（stageConfig.name）
該階段建議的人事成本區間（min ~ max %）
你現在的 HR Ratio 幾 %（通常遠高於上限）
點出「這些錢原本應該投在」：
市場拓展
行銷品牌
業務擴展
設備更新
職員訓練
資金儲備
妥協方案（generateCompromiseSolution）：
根據 primaryEngine 找對應的 engineToDepartmentWeights
把部門按 weight 排序
第一名：🥇 優先部門（核心引擎部門）
第二名：🥈 次要部門（支撐引擎運作）
其餘：象徵性發放名單
用一句話術說明：
優先部門理由：您的 XXX 引擎的核心部門
次要部門理由：支撐增長引擎運作

3.4 增長引擎診斷（calculateEngine）
資料來源： industryGrowthEngineQuestions
每個行業族群都有一份 3 題、單選題的問卷
每個選項對應一個引擎（sales_led、ops_led…）
計算方式：
Q1–Q3，每題選到某引擎一次即加 1 分
分數最高者 → primaryEngine
若平手，以 Q1 答案優先
知識庫用途：
每個行業族群（餐飲、專業服務、製造、教育、醫療、物流、房仲／裝修、美容／健身、科技軟體、金融保險、營造、批發零售、專業技術顧問、default）都有一套題目，可以當作「諮詢訪談腳本」。

3.5 部門權重與說明（engineToDepartmentWeights + departmentWeightReasons）
目的：將「增長引擎」轉換成「部門優先順序」。
例：sales_led
sales：1.5（核心）
pr_marketing：1.2
product_service：0.9
rd_qa：0.7
assets_finance：0.6
hr：0.6
management：0.8

每個引擎都有一組對應的 7 部門權重＋說明文字，說明例如：
「業務銷售是銷售驅動型的核心」
「公關行銷協助開發新客戶」
「產品服務提供支撐」

知識庫應收錄：
每一種引擎 → 各部門權重數值表
各部門對應的中文說明（為什麼這個部門在這個引擎下重要）

3.6 獎金池決策邏輯（年終獎金）
計算 理想人事成本上限：
idealTotalHRCost = grossProfit × stage.hrRatioRange.max
判斷是否超支：
isOverBudget = (annualHRCost > idealTotalHRCost)
若超支比例 > 150%：視為嚴重超支
建立三層獎金建議：
standardBonusPool = idealTotalHRCost × stage.bonusAllocation.yearEndBonusRatio
conservativeBonusPool = standard × 50%
ultraConservativeBonusPool = 0
決策：
若 未超支：使用 standardBonusPool

若 嚴重超支（>150%）：建議 totalBonusPool = 0
若 輕度超支：
檢查看 annualHRCost + conservativeBonusPool 是否 > maxTotalPayrollLimit = idealTotalHRCost × 1.5
若超過，就縮小獎金到 不超過 150% 上限 的最大值
否則使用 conservativeBonusPool
知識點：這裡其實是把「現實人事成本」跟「理想人事成本上限」做對比，讓系統可以說出：「你現在已經吃掉未來投資的錢了，所以獎金要保守。」

3.7 部門獎金分配模式（標準 vs 優先級保障）
計算部門權重
calculatedWeight = engineWeights[dept.type] || 1.0
totalWeight = Σ dept.calculatedWeight
標準模式：
分配比例（部門）＝ calculatedWeight / totalWeight
部門獎金＝ totalBonusPool × 分配比例
人均獎金＝ 部門獎金 / headcount
理由：使用 departmentWeightReasons＋權重資訊
優先級保障模式（allocateBonusWithPriority）
啟動條件：
已超支（isOverBudget = true）
且 totalBonusPool < standardBonusPool × 80% → 視為「資源明顯不足」

步驟：
按 calculatedWeight 從大到小排序
分層：
核心部門：weight ≥ 1.3
重要部門：1.0 ≤ weight < 1.3
支撐部門：weight < 1.0
預算配置：
60% 給核心部門
30% 給重要部門
剩餘給支撐部門；若剩餘為 0，則支撐部門獎金為 0，並加上「資源緊張，暫緩發放」提示
每個部門的 reason 裡會寫：
該部門在此引擎下的角色說明
標示層級（核心／重要／支撐）
類似：「（核心部門優先保障，權重 1.5 倍）」


4. 使用情境與解讀話術（給顧問用）
4.1 如何向老闆解釋「四階段 × HR Ratio」
生存期：
你的企業現在還在保命階段，人事成本應該盡量壓在毛利的 30–40%。這時候獎金主要是為了「關鍵少數」留下來，不能太灑。
組織期：
你已經開始有一些穩定輸出，這時候要慢慢養「合適的人」。獎金可以用來拉開關鍵職位和一般職位的差距。
擴展期：
你現在是在「搶速度」的階段，人事成本可以到 50–60%，但獎金要偏短期、偏業績，讓團隊快打快收。
規模期：
你已經坐穩一個規模，需要的是效率而不是衝刺。薪水偏穩定，獎金比例可以下降，改以長期激勵為主。

4.2 當 HR Ratio 過高時的標準話術
工具幫你準備的結構是：
告訴他「在你這個階段，合理區間應該是多少」
告訴他「你現在已經吃掉了哪些本來要投資成長的錢」
提妥協方案：
「如果你還是一定要發年終，我會建議這樣排順序…」

4.3 增長引擎如何連到部門獎金
「銷售驅動」→ 業務 1.5 倍權重、行銷 1.2 倍
「營運驅動」→ 產品／服務、研發品管權重最高
「媒體驅動」→ 行銷最高，業務與產品次之
「通路驅動」→ 業務＋產品，搭配通路角色
「創辦人驅動」→ 管理層＋業務
「產品驅動」→ 產品／服務＋研發為核心
你在課程或顧問時，可以說：
「既然你過去 12 個月的成長，是靠 XXX，那我們在獎金上就要把 XXX 對應的部門，放在第一順位，不然你就是用獎金在『獎錯地方』。」
