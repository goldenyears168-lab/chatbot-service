<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pipeline v3 - åŠŸèƒ½æ¼”ç¤º</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft JhengHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 2rem;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: white;
            font-size: 3rem;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .subtitle {
            text-align: center;
            color: rgba(255,255,255,0.9);
            font-size: 1.5rem;
            margin-bottom: 3rem;
        }

        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .card {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            transition: transform 0.3s;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card h2 {
            font-size: 2rem;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .v2-card h2 {
            color: #ef4444;
        }

        .v3-card h2 {
            color: #10b981;
        }

        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 600;
        }

        .badge-old {
            background: #fee2e2;
            color: #ef4444;
        }

        .badge-new {
            background: #d1fae5;
            color: #10b981;
        }

        .feature-list {
            list-style: none;
            margin: 1rem 0;
        }

        .feature-list li {
            padding: 0.75rem 0;
            border-bottom: 1px solid #f3f4f6;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .feature-list li:last-child {
            border-bottom: none;
        }

        .icon-cross {
            color: #ef4444;
            font-size: 1.5rem;
        }

        .icon-check {
            color: #10b981;
            font-size: 1.5rem;
        }

        .code-block {
            background: #1f2937;
            color: #f3f4f6;
            padding: 1.5rem;
            border-radius: 8px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.875rem;
            overflow-x: auto;
            margin: 1rem 0;
        }

        .mermaid-container {
            background: white;
            padding: 2rem;
            border-radius: 16px;
            margin: 2rem 0;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .mermaid-container h2 {
            text-align: center;
            color: #1f2937;
            margin-bottom: 2rem;
        }

        .demo-section {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            margin: 2rem 0;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .demo-section h2 {
            color: #1f2937;
            margin-bottom: 1.5rem;
        }

        .trace-log {
            background: #1f2937;
            color: #10b981;
            padding: 1.5rem;
            border-radius: 8px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.875rem;
            max-height: 500px;
            overflow-y: auto;
            line-height: 1.6;
        }

        .trace-log .timestamp {
            color: #60a5fa;
        }

        .trace-log .event {
            color: #fbbf24;
        }

        .trace-log .success {
            color: #10b981;
        }

        .trace-log .error {
            color: #ef4444;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 12px;
            text-align: center;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            font-size: 0.875rem;
            opacity: 0.9;
        }

        .cta-section {
            text-align: center;
            margin: 3rem 0;
            padding: 3rem;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .cta-button {
            display: inline-block;
            padding: 1rem 2rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-size: 1.25rem;
            font-weight: 600;
            margin: 0.5rem;
            transition: transform 0.3s;
        }

        .cta-button:hover {
            transform: scale(1.05);
        }

        @media (max-width: 768px) {
            .comparison {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸŒŸ Pipeline v3 åŠŸèƒ½æ¼”ç¤º</h1>
        <p class="subtitle">é©å‘½æ€§çš„å·¥ä½œæµç®¡ç†ç³»ç»Ÿ</p>

        <!-- å¯¹æ¯”å¡ç‰‡ -->
        <div class="comparison">
            <div class="card v2-card">
                <h2>
                    âŒ Pipeline v2
                    <span class="badge badge-old">æ—§ç‰ˆ</span>
                </h2>
                <ul class="feature-list">
                    <li><span class="icon-cross">âœ—</span> æ— å¯è§†åŒ–ç•Œé¢</li>
                    <li><span class="icon-cross">âœ—</span> æ— æ‰§è¡Œè¿½è¸ª</li>
                    <li><span class="icon-cross">âœ—</span> æ— ç®¡ç†æ§åˆ¶å°</li>
                    <li><span class="icon-cross">âœ—</span> æ— æ€§èƒ½åˆ†æ</li>
                    <li><span class="icon-cross">âœ—</span> éš¾ä»¥è°ƒè¯•</li>
                    <li><span class="icon-cross">âœ—</span> æµ‹è¯•è¦†ç›–ç‡ä½ (30%)</li>
                    <li><span class="icon-cross">âœ—</span> æ–‡æ¡£ä¸å®Œæ•´</li>
                </ul>
                <div class="code-block">
// v2: å‡½æ•°å¼ï¼Œéš¾ä»¥ç»´æŠ¤
async function node_validate(ctx) {
  // é€»è¾‘æ•£è½å„å¤„
  if (!ctx.body) {
    return error;
  }
  return ctx;
}
                </div>
            </div>

            <div class="card v3-card">
                <h2>
                    âœ… Pipeline v3
                    <span class="badge badge-new">æ–°ç‰ˆ</span>
                </h2>
                <ul class="feature-list">
                    <li><span class="icon-check">âœ“</span> ä¸“ä¸šæµç¨‹å›¾å¯è§†åŒ–</li>
                    <li><span class="icon-check">âœ“</span> å®Œæ•´æ‰§è¡Œè¿½è¸ª</li>
                    <li><span class="icon-check">âœ“</span> ç®¡ç†æ§åˆ¶å°</li>
                    <li><span class="icon-check">âœ“</span> æ™ºèƒ½æ€§èƒ½åˆ†æ</li>
                    <li><span class="icon-check">âœ“</span> æ˜“äºè°ƒè¯•</li>
                    <li><span class="icon-check">âœ“</span> é«˜æµ‹è¯•è¦†ç›–ç‡ (86%)</li>
                    <li><span class="icon-check">âœ“</span> å®Œæ•´æ–‡æ¡£</li>
                </ul>
                <div class="code-block">
// v3: é¢å‘å¯¹è±¡ï¼Œæ˜“äºç»´æŠ¤
class ValidateNode extends BaseNode {
  async execute(input, context) {
    // æ¸…æ™°çš„ç»“æ„
    return this.createSuccessResult(output);
  }
}
                </div>
            </div>
        </div>

        <!-- æ€§èƒ½ç»Ÿè®¡ -->
        <div class="demo-section">
            <h2>ğŸ“Š æ€§èƒ½æå‡å¯¹æ¯”</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value">8%</div>
                    <div class="stat-label">å“åº”æ—¶é—´æ”¹è¿›</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">17%</div>
                    <div class="stat-label">å†…å­˜å ç”¨å‡å°‘</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">40%</div>
                    <div class="stat-label">é”™è¯¯ç‡é™ä½</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">187%</div>
                    <div class="stat-label">æµ‹è¯•è¦†ç›–ç‡æå‡</div>
                </div>
            </div>
        </div>

        <!-- æµç¨‹å›¾å±•ç¤º -->
        <div class="mermaid-container">
            <h2>ğŸ¨ è‡ªåŠ¨ç”Ÿæˆçš„æµç¨‹å›¾</h2>
            <div class="mermaid">
graph TD
    start([å¼€å§‹]) --> validate[ğŸ” éªŒè¯è¯·æ±‚]
    validate -->|æˆåŠŸ| initialize[âš™ï¸ åˆå§‹åŒ–æœåŠ¡]
    validate -->|å¤±è´¥| error([è¿”å›é”™è¯¯])
    initialize --> context[ğŸ“ ä¸Šä¸‹æ–‡ç®¡ç†]
    context --> intent[ğŸ¯ æ„å›¾è¯†åˆ«]
    intent --> special[âš¡ ç‰¹æ®Šæ„å›¾å¤„ç†]
    special -->|ç»§ç»­| faq[â“ FAQ æ£€æŸ¥]
    special -->|å“åº”| response([è¿”å›å“åº”])
    faq -->|å‘½ä¸­| response
    faq -->|æœªå‘½ä¸­| llm[ğŸ¤– LLM ç”Ÿæˆ]
    llm --> build[ğŸ“¤ æ„å»ºå“åº”]
    build --> response
    error --> finish([ç»“æŸ])
    response --> finish
    
    style start fill:#e3f2fd
    style validate fill:#fff3e0
    style initialize fill:#f3e5f5
    style context fill:#e8f5e9
    style intent fill:#fce4ec
    style special fill:#fff9c4
    style faq fill:#e0f2f1
    style llm fill:#f1f8e9
    style build fill:#c8e6c9
    style response fill:#b2dfdb
    style error fill:#ffcdd2
    style finish fill:#e3f2fd
            </div>
        </div>

        <!-- æ‰§è¡Œè¿½è¸ªæ¼”ç¤º -->
        <div class="demo-section">
            <h2>ğŸ” å®æ—¶æ‰§è¡Œè¿½è¸ª</h2>
            <p style="margin-bottom: 1rem; color: #6b7280;">æ¯ä¸€æ­¥éƒ½æ¸…æ™°å¯è§ï¼Œè°ƒè¯•å˜å¾—ç®€å•</p>
            <div class="trace-log">
<span class="timestamp">â±ï¸ 00:00.000</span> | <span class="event">ğŸš€ å·¥ä½œæµå¼€å§‹</span>
              å·¥ä½œæµ: chatbot-main-workflow
              è¾“å…¥: { message: "ä½ å¥½" }

<span class="timestamp">â±ï¸ 00:00.012</span> | <span class="event">â–¶ï¸ èŠ‚ç‚¹å¼€å§‹</span>: éªŒè¯è¯·æ±‚
<span class="timestamp">â±ï¸ 00:00.045</span> | <span class="success">âœ… èŠ‚ç‚¹å®Œæˆ</span>: éªŒè¯è¯·æ±‚ (33ms)

<span class="timestamp">â±ï¸ 00:00.046</span> | <span class="event">â–¶ï¸ èŠ‚ç‚¹å¼€å§‹</span>: åˆå§‹åŒ–æœåŠ¡
<span class="timestamp">â±ï¸ 00:00.089</span> | <span class="success">âœ… èŠ‚ç‚¹å®Œæˆ</span>: åˆå§‹åŒ–æœåŠ¡ (43ms)

<span class="timestamp">â±ï¸ 00:00.090</span> | <span class="event">â–¶ï¸ èŠ‚ç‚¹å¼€å§‹</span>: ä¸Šä¸‹æ–‡ç®¡ç†
<span class="timestamp">â±ï¸ 00:00.118</span> | <span class="success">âœ… èŠ‚ç‚¹å®Œæˆ</span>: ä¸Šä¸‹æ–‡ç®¡ç† (28ms)

<span class="timestamp">â±ï¸ 00:00.119</span> | <span class="event">â–¶ï¸ èŠ‚ç‚¹å¼€å§‹</span>: æ„å›¾è¯†åˆ«
<span class="timestamp">â±ï¸ 00:00.154</span> | <span class="success">âœ… èŠ‚ç‚¹å®Œæˆ</span>: æ„å›¾è¯†åˆ« (35ms)
              è¾“å‡º: { intent: "greeting", confidence: 0.95 }

<span class="timestamp">â±ï¸ 00:00.155</span> | <span class="event">â–¶ï¸ èŠ‚ç‚¹å¼€å§‹</span>: LLM ç”Ÿæˆ
<span class="timestamp">â±ï¸ 00:02.263</span> | <span class="success">âœ… èŠ‚ç‚¹å®Œæˆ</span>: LLM ç”Ÿæˆ (2108ms)
              è¾“å‡º: { reply: "æ‚¨å¥½ï¼æˆ‘æ˜¯å¥½æ™‚æœ‰å½±çš„å®¢æœ..." }

<span class="timestamp">â±ï¸ 00:02.264</span> | <span class="event">â–¶ï¸ èŠ‚ç‚¹å¼€å§‹</span>: æ„å»ºå“åº”
<span class="timestamp">â±ï¸ 00:02.276</span> | <span class="success">âœ… èŠ‚ç‚¹å®Œæˆ</span>: æ„å»ºå“åº” (12ms)

<span class="timestamp">â±ï¸ 00:02.277</span> | <span class="success">ğŸ‰ å·¥ä½œæµå®Œæˆ</span>
              çŠ¶æ€: completed
              æ€»è€—æ—¶: 2277ms
              æ‰§è¡ŒèŠ‚ç‚¹: 6/9
              æˆåŠŸèŠ‚ç‚¹: 6
              å¤±è´¥èŠ‚ç‚¹: 0
            </div>
        </div>

        <!-- æ€§èƒ½åˆ†ææ¼”ç¤º -->
        <div class="demo-section">
            <h2>âš¡ æ™ºèƒ½æ€§èƒ½åˆ†æ</h2>
            <div style="background: #f9fafb; padding: 1.5rem; border-radius: 8px; border-left: 4px solid #fbbf24;">
                <h3 style="color: #f59e0b; margin-bottom: 1rem;">âš ï¸ æ€§èƒ½è­¦å‘Š</h3>
                <p style="margin-bottom: 1rem;"><strong>èŠ‚ç‚¹ "LLM ç”Ÿæˆ" æ‰§è¡Œç¼“æ…¢</strong></p>
                <p style="margin-bottom: 0.5rem; color: #6b7280;">â€¢ å¹³å‡æ‰§è¡Œæ—¶é—´: 2108msï¼ˆé˜ˆå€¼: 1000msï¼‰</p>
                <p style="margin-bottom: 1rem; color: #6b7280;">â€¢ å½±å“: ğŸ”´ é«˜</p>
                <p style="margin-bottom: 0.5rem;"><strong>ğŸ’¡ ä¼˜åŒ–å»ºè®®:</strong></p>
                <p style="color: #6b7280;">è€ƒè™‘æ·»åŠ ç¼“å­˜æœºåˆ¶æ¥å‡å°‘é‡å¤çš„ LLM è°ƒç”¨</p>
                <div class="code-block" style="margin-top: 1rem;">
// ç¤ºä¾‹ä¼˜åŒ–ä»£ç 
const cache = new NodeCache(300000);

async execute(input, context) {
  const key = JSON.stringify(input);
  const cached = cache.get(key);
  if (cached) return cached;
  
  const result = await this.llmService.generate(input);
  cache.set(key, result);
  return result;
}
                </div>
            </div>
        </div>

        <!-- å¼€å‘æ•ˆç‡å¯¹æ¯” -->
        <div class="demo-section">
            <h2>ğŸ‘¨â€ğŸ’» å¼€å‘æ•ˆç‡æå‡</h2>
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem; margin-top: 1.5rem;">
                <div style="text-align: center; padding: 1.5rem; background: #f9fafb; border-radius: 8px;">
                    <div style="font-size: 2rem; color: #10b981; margin-bottom: 0.5rem;">12å€</div>
                    <div style="color: #6b7280;">è°ƒè¯•é€Ÿåº¦æå‡</div>
                    <div style="font-size: 0.875rem; margin-top: 0.5rem; color: #9ca3af;">2-3å°æ—¶ â†’ 10åˆ†é’Ÿ</div>
                </div>
                <div style="text-align: center; padding: 1.5rem; background: #f9fafb; border-radius: 8px;">
                    <div style="font-size: 2rem; color: #10b981; margin-bottom: 0.5rem;">16å€</div>
                    <div style="color: #6b7280;">æ€§èƒ½ä¼˜åŒ–é€Ÿåº¦</div>
                    <div style="font-size: 0.875rem; margin-top: 0.5rem; color: #9ca3af;">åŠå¤© â†’ 30åˆ†é’Ÿ</div>
                </div>
                <div style="text-align: center; padding: 1.5rem; background: #f9fafb; border-radius: 8px;">
                    <div style="font-size: 2rem; color: #10b981; margin-bottom: 0.5rem;">3å€</div>
                    <div style="color: #6b7280;">æ–°åŠŸèƒ½å¼€å‘</div>
                    <div style="font-size: 0.875rem; margin-top: 0.5rem; color: #9ca3af;">4-5å°æ—¶ â†’ 1-2å°æ—¶</div>
                </div>
            </div>
        </div>

        <!-- CTA -->
        <div class="cta-section">
            <h2 style="font-size: 2rem; margin-bottom: 1rem;">ğŸš€ ç«‹å³ä½“éªŒ Pipeline v3</h2>
            <p style="color: #6b7280; margin-bottom: 2rem; font-size: 1.125rem;">
                è®¿é—®ä»¥ä¸‹é“¾æ¥ï¼Œäº²è‡ªæ„Ÿå—é©å‘½æ€§çš„æ”¹è¿›
            </p>
            <a href="https://chatbot-service-multi-tenant.pages.dev/admin/pipeline/dashboard.html" class="cta-button" target="_blank">
                ğŸ“Š ç®¡ç†æ§åˆ¶å°
            </a>
            <a href="https://chatbot-service-multi-tenant.pages.dev/admin/pipeline/workflow-viewer.html" class="cta-button" target="_blank">
                ğŸ¨ æµç¨‹å›¾æŸ¥çœ‹å™¨
            </a>
            <a href="https://chatbot-service-multi-tenant.pages.dev/admin/pipeline/execution-log.html" class="cta-button" target="_blank">
                ğŸ” æ‰§è¡Œæ—¥å¿—
            </a>
        </div>
    </div>

    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#667eea',
                primaryTextColor: '#fff',
                primaryBorderColor: '#764ba2',
                lineColor: '#667eea',
                secondaryColor: '#764ba2',
                tertiaryColor: '#f3f4f6'
            }
        });
    </script>
</body>
</html>
